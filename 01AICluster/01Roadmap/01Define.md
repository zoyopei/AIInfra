# 高性能计算HPC定义
Author by: 陈悦孜

AI大模型的运行离不开强大算力的支撑，这种算力的实现高度依赖于由众多处理器互联而成的AI算力集群和具备顶尖计算能力的超级计算机。 在这些复杂系统的背后，高性能计算（High Performance Computing, HPC）是构建AI算力集群和驱动超级计算机的基石。它通过并行处理、高速互联网络和先进架构，将海量计算资源整合起来，提供远超单机的处理能力。算力（Computational Power），作为衡量计算系统单位时间内处理信息能力的核心指标，正是评估高性能计算效能的重要标尺

这里介绍计算集群之路的介绍将从高性能计算定义、高性能计算的发展趋势、集群计算的发展历程、集群计算的系统挑战和集群计算的系统架构几个方面进行展开。本文将介绍高性能计算相关的内容，从介绍什么是算力、高性能计算相关的应用和集群计算及其相关计算中心三个部分着手，开启计算集群之路的序章。

![计算集群之路](images/00outline.png)


## 什么是算力

算力是衡量计算机处理信息能力的核心单位。首先这里先介绍高性能计算相关的概念和单位，算力增长的情况和相关背景。

### 算力衡量单位
算力水平是如何衡量的？

算力水平用单位FLOPS(Floating point Operations Per Second)每秒浮点计算次数来衡量。HPC一般数据类型为64位双字长精度（FP64），所以FLOPS一般采用FP64的算力水平来评估。

这里64位双字长精度（FP64）为IEEE-754标准双精度浮点数$D = (-1)s \times 1.f \times 2^{e-1023}$。其中$s$是符号位（0为正1为负），$f$是（52位二进制）尾数，$e$是（11位二进制）指数。

以下是更多不同数量级的浮点运算单位。

|Name | Unit（单位）|Value |中文描述|算力水平约等于多少部Mate40 Pro |
|-|-|-|-|-|
|Kilo FLOPS|KFLOPS| $10^{3}$ |每秒一千次|0.000000001部|
|Mega FLOPS |MFLOPS|$10^{6}$|每秒一百万次|0.000001部|
|Giga FLOPS |GFLOPS|$10^{9}$|每秒十亿次|0.001部|
|Tera FLOPS | TFLOPS |$10^{12}$|每秒一万亿次|一部Mate40Pro，$\frac{1}{12}$部XBOX|
|Peta FLOPS |PFLOPS|$10^{15}$|每秒一千万亿次|一千部（武汉超算，算力200P）|
|Exa FLOPS | EFLOPS | $10^{18}$|每秒一百京次|一百万部（深圳超算，算力2.5E）|
|Zetta FLOPS | ZFLOPS |  $10^{21}$|每秒十万京次|十亿部|
|Yotta FLOPS | YFLOPS |  $10^{24}$|每秒十亿京次|一万亿部|



### 算力增长情况

数字经济时代，算力是国家间的核心竞争力，中国人均算力当前仅为美国的1/5，提升空间巨大；预计到2026年，中国算力市场将持平甚至超越美国。

习总书记在 2018 年关于自主创新重要讲话中提出“数字经济不能建设在沙滩上”，中国需要掌握创新和发展主动权，促进中国产业迈向全球价值链高端，同时需要掌握核心技术，加快推进国产自主可控替代。除此之外，中国发达的基建能力也要延展到新基建，包括数字新基建（数据中心）和智能新基建（人工智能），他同时在 2022 年 4 月 26 日主持召开的中央财经委员会第十一次会议中提出要加强信息、科技、物流等产业升级基础设施建设，布局建设新一代超算、云计算、人工智能平台、宽带基础网络等设施，推进重大科技基础设施布局建设，“要适度超前，布局有利于引领产业发展和维护国家安全的基础设施”。

工信部数据显示，截至2024年三季度末，中国算力总规模达268FLOPS（每秒百亿亿次浮点运算，以FP32单精度计算），算力应用项目超过1.3万个，在用算力中心机架总规模超过880万架标准机架，算力总规模世界前列。

同时，全球算力规模将持续增长，算力需求由于AI的应用将持续增长。1961年，AI之父John McCarthy提出：“算力服务将成为未来的公共基础设施”，同电话网络一样重要。预计2030年，全球产生数据量年均复合增长29.6%，通用算力需求将增长10倍，AI算力需求将增长500倍。

![全球经济增长产生更多数据，AI成为算力的主要引擎](images/01Define01.png)


## 高性能计算的应用
高性能计算（HPC）作为强大的问题求解引擎。在科学研究方面，它支撑着气候精准预测、宇宙演化模拟、新药研发（如蛋白质折叠、虚拟筛选）以及新材料探索（原子级模拟），极大地拓展了人类认知边界。工程与工业领域则依赖HPC进行复杂的产品设计与优化（如飞机气动、汽车碰撞、芯片设计）、石油勘探地震成像以及制造工艺仿真，显著提升了效率并降低了成本。高性能计算在数值分析和并行计算的突出应用，使其在处理海量数据、进行极度复杂的模拟与计算发挥重要作用，从而驱动众多关键领域的突破与创新。

### 数值分析
数值分析是高性能计算重要应用领域之一。数值计算是数学的近似求解方法，专注于设计算法，将连续数学问题（如微分方程、积分、优化等）转化为离散的数值运算（如矩阵计算、迭代逼近），通过计算机有限精度实现近似解。

数值分析在多个领域有广泛的应用，为问题的解决提供算法，而高性能计算提供算力和解决工具。对于我们日常接触的天气预报，全球气候模拟就用到数值计算的有限元法离散大气方程，高性能计算的万核并行计算在10天内就能完成百年气候模拟；在药品研发领域，蒙特卡洛模拟分子动力学的数值分析方法用GPU集群加速10万次分子相互作用计算。

北大有名的韦神研究方向就是N-S方程，数值分析是求解N-S方程的核心方法。N-S方程是描述流体运动的基础方程，但其复杂的数学特性（非线性、多变量耦合、复杂边界条件）导致解析解（精确的数学表达式）在绝大多数实际情况下无法获得。因此，必须依赖数值分析方法来获得近似解。当解析解不存在或难以获得时，数值分析提供可靠、高效的数值解方案。高性能计算可以处理超大规模问题，并行化计算帮助实现数值分析算法。



### 并发计算和并行计算

HPC = 大规模并行 × 高效并发

并发计算和并行计算是实现高性能计算的重要方法。并行计算提供横向扩展能力，将问题拆分到海量计算单元，实现算力质变。并发计算在硬件层面纵向优化资源利用，通过任务调度减少空闲等待。二者协同实现高性能计算的高算力。

并发计算(Concurrent Computing)是一种程序计算形式，在系统中，至少有两个以上的计算任务在同时运作，计算结果可能同时发生。并发概念强调的是单个处理器在单位时间内完成多个任务，类似“一个人同时吃三个馒头”。高性能计算在单节点内，并发技术（如多线程） 充分压榨硬件性能。

并行计算(Parallel Computing)一般是指许多指令得以同时进行的计算模式。在同时进行的前提下，可以将计算的过程分解成小部分，之后以并发方式来加以解决。并行概念强调的是多个处理器同时完成多个任务。高性能计算通过大规模并行化突破单机算力极限。

![并发计算和并行计算](images/01Define02.png)

## 集群计算（高性能计算中心、云数据中心、AI智算中心）

计算机集群简称集群，是一种计算机系统，它通过一组松散集成的计算机软件或硬件连接起来高度紧密地协作完成计算工作。集群是一个完整系统，而非多个计算机系统，可以被看作是一整台计算机（类似于“蚁群”/“蜂群”社会系统），是主要的算力基础设施建设方式。

![机房里的集群](images/01Define03.jpg)

### 算力基础设施建设
计算集群从分层堆叠走向集群全栈优化，达成规模系统最优。

算力基础设施的建设模式正经历根本性转变，核心趋势是从传统的“分层堆叠”演进为“集群全栈优化”，目标直指在超大规模部署下实现系统级的整体最优性能、效率和成本平衡（规模系统最优）。

传统的分层堆叠模式（硬件、虚拟化、调度、应用等层级依赖标准化接口交互）虽具模块化和局部优化优势，但在应对AI大模型训练、超大规模数据分析等新兴负载时暴露显著局限：层级交互成为性能瓶颈，局部优化难以转化为全局效能；各层资源需求差异导致利用率不均衡，难以逼近理论峰值；跨层协同与问题定位困难；且随着集群规模急剧扩张，其管理复杂度和性能瓶颈被放大，可扩展性面临挑战。

为突破这些限制并满足海量算力的严苛需求，集群全栈优化应运而生成为新范式。其核心在于打破严格层级界限，以全局视角将整个集群视为统一资源池，对从底层芯片、高速网络（如RDMA）、存储介质、异构计算单元（CPU/GPU/NPU）到上层操作系统、虚拟化/容器化、智能调度器（具备拓扑与需求感知能力）、运行时、框架（如TensorFlow/PyTorch）直至应用的全技术栈进行穿透性的协同设计、深度整合与一体化调优。这体现在软硬件协同（如DPU/IPU硬件卸载、专用指令集优化软件）、端到端数据流优化、基于全局信息的智能调度决策以及跨层级信息互通以支持更优策略。全栈优化的终极目标是确保在成千上万节点的大规模实际运行环境中，系统能在关键指标上达成综合最优：包括实现极致任务吞吐量与超低延迟（如缩短大模型训练周期）、最大化资源利用率（CPU/内存/网络/存储/加速卡）与能效比（性能/瓦特）以降低运营成本与碳排放、优化总拥有成本（TCO），同时保障接近线性的可扩展性和高可靠性。

之所以必须转向全栈优化，根源在于大规模场景下，任何局部的、未被协同解决的短板（如网络拥塞、调度失当）都会被急剧放大（木桶效应），分层堆叠的局部优化范式无法应对系统级的复杂性与瓶颈，而全栈协同是释放超大规模算力潜力、构建高效能、低成本、可持续基础设施以赢取AI时代核心竞争力的必由之路。

![集群形态变化](images/01Define04.png)


在传统数据中心中，服务器部署人工连线耗时长，故障率高，施工维护复杂；散热系统以风冷为主，系统能效差。计算、散热、电源网络松耦合集成，算力利用率低、算力密度低。

由下图可见服务器形态演进，服务器先由主板裸机形态，在不同场景下组装成不同样式的服务器节点，在云场景下有标准公有云计算服务器，在大数据应用场景下数据服务器节点、在高密计算场景下有HPC服务器，在AI应用场景下有AI服务器节点。不管是什么业务，这些服务器发展演进都有向标准的服务器机柜内堆叠发展的趋势，最终到现在的集群时代。

![服务器进化历程](images/01Define05.png)


集群计算规模应用场景有高性能计算中心、人工智能计算中心和云数据中心。

![集群计算规模不同应用场景](images/01Define06.png)

计算中心是面向特定计算需求的高性能并行计算的专用集群。主要面向国防、科研等重算力超算场景，以及人工智能大模型训练场景，算力和功耗惊人，它的体系架构专为特定应用算力定制优化。计算中心又分为高性能计算中心和人工智能计算中心。

高性能计算中心顾名思义用于高性能计算的计算集群。高性能计算是衡量和体现国家科技核心竞争力和综合国力重要标志，各国公认支撑科学技术发展战略技术。科研三大范式有理论、实验、计算，计算是科研的三大范式之一。高性能计算适用领域广泛，上可算天，算来人类第二张黑洞照片；下可算地，算得全球水循环变化；算人算物，分别在生命科学和战略装备都有突出的应用成果。

![高性能计算应用](images/01Define07.png)

人工智能计算中心由于人工智能计算的需求爆发而应运而生。AI成为新形势下中美科技竞争的新赛道，大数据和大模型驱动的训练和推理应用场景使得智能算力爆发增长。大模型算力需求远超硬件算力供给，前者每2年增长750倍而后者每2年仅增长3倍。基于FFN前馈神经网络和Attention注意力机制的Transformer通用大模型架构让模型规模和训练算力都变大，使得算力需求更为高。

![人工智能计算模型演进和算力应用](images/01Define08.png)

云数据中心是面向通用计算的大规模并发处理的集群。面向大众商用，提供互联网IT服务，并行处理规模惊人，计算相对简单，强调高性价比和高兼容性，对可靠性、可用性、可服务性（RAS）要求高。云数据中心采用高并发通用云计算。它有以下特点：<br>
（1）资源按需分配，资源全面虚拟化，不同粒度按需弹性分配。<br>
数据中心通过虚拟化技术（如KVM、容器）将物理资源（CPU/内存/存储）池化。用户按需申请资源，系统动态分配，同时云数据中心支持秒级扩容/缩容）。如此可以减少资源闲置（避免传统服务器的低利用率）， 降低用户成本（仅为实际用量付费，无需预先采购硬件）。<br>
（2）服务无处不在，服务通过网络公开，随时随地接入/控制。<br>
全球分布式节点和多可用区（AZ）容灾架构保障服务可接入性和连续性。公有云服务（如AWS/Azure/阿里云）通过互联网开放API和控制台，用户可通过Web、手机App、命令行随时管理资源。云数据中心的服务打破地域限制，有较高的业务敏捷性。<br>
（3）绿色节能，降低能耗、提高算效、降低OPEX。<br>
OPEX，Operational Expenditure，指企业日常运营产生的持续性支出（如电费、带宽费、维护费、人力成本）的运营支出。<br>云数据中心降低OPEX的能源成本，在硬件层使用低功耗CPU（如ARM架构）、液冷散热来降低电费成本，在软件层使用智能调度算法（将任务迁移到空闲服务器）减少算力浪费，在架构层使用高压直流供电（HVDC）、自然冷却（新风系统）降低机房制冷成本。<br>
（4）集约化建设：降低TTM和CAPEX。<br>
TTM,Time to Market,指产品/服务从概念设计到正式上市商用所需的时间，即上市时间。<br>
CAPEX，Capital Expenditure，指企业为长期资产投入的一次性大额支出（如服务器采购、机房建设、硬件购置），即资本支出。<br>
对于建设成本（CAPEX）的优化，云数据中心集中采购服务器/交换机/存储设备，规模效应降低采购成本，用户无需采购；至于缩短上市时间（TTM），相比于传统部署需要采购部署，用户租用云资源可以立即开通使用；运维工作也由云厂商统一管理运维，用户无需考虑。

![云数据中心](images/01Define10.png)

总结这三种计算集群的特点和区别如下。

| 集群类型             | 应用目的   | 数据类型                  | 计算特征       | 网络特征                          | 存储特征          |
| :------------------- | :--------- | :------------------------ | :---------------------------- | :-------------------------------- | :---------------- |
| **HPC高性能计算中心**<br>(高度专用) | 国防科研   | FP64双精度                | 重算力，密集计算，高并行 | • 密集通信<br>• 流量特征各异<br>• 部分通信可隐藏 | • 密集&复杂IO     |
| **AI人工智能计算中心**<br>(训练/推理) | AI训练推理 | • FP16半精度<br>• BF16/FP8/FP4<br>• FP32全精度 | 重算力，密集计算，高并行                    | • 密集通信<br>• 部分通信可隐藏      | • 密集IO<br>• 按节奏迭代 |
| **云数据中心** <br>(通用计算)      | 互联网云计算 | • INT32整型<br>• FP32全精度 | • 通用计算<br>• 高并发        | • 分散通信                        | • 分散/密集IO     |



## 本节视频

<html>
<iframe src="https://player.bilibili.com/player.html?isOutside=true&aid=114750084095236&bvid=BV1s5KfzzEbo&cid=30712332864&p=1&as_wide=1&high_quality=1&danmaku=0&t=30&autoplay=0" width="100%" height="500" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>
</html>
